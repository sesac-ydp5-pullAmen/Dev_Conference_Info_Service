<!DOCTYPE html>
<html lang="en">
    <head>
        <%- include('../../common/head.ejs', {title: '관리자페이지' }) %>
        <link rel="stylesheet" href="/static/css/pages/myPage/manager.css" />
        <link
            rel="stylesheet"
            href="/static/css/pages/myPage/managerAside.css"
        />
    </head>
    <body>

        <h1>관리자 페이지</h1>
        <button type="button" onclick="getUser()">전체 유저 보기</button>
        <!-- 전체 유저 불러오는 allUser.ejs로 이동 -->

        <button type="button" onclick="getAllConference()">전체 행사 리스트</button>
        <button type="button" onclick="getConferenceHandler()">행사 관리 페이지</button>

    </body>
    <script>
        // 전체 유저 보기
        function getUser() {
                axios({
                    method: 'GET',
                    url: '/manager/allUser',
                }).then((res) => {
                    if (res.status === 200) {
                        window.location.href = '/manager/allUser';
                    }
                })
        };
        // 전체 행사 보기
        function getAllConference() {
                axios({
                    method: 'GET',
                    url: '/manager/allConference',
                }).then((res) => {
                    if (res.status === 200) {
                        window.location.href = '/manager/allConference';
                    }
                })
        };
        // 등록 신청한 행사 보기

        function getConferenceRegister() {
            axios({
                method: 'GET',
                url: '/manager/getConferenceRegister',
            }).then((res) => {
                if (res.status === 200) {
                    const conferenceList = res.data.conferences;
                    if (
                        Array.isArray(conferenceList) &&
                        conferenceList.length > 0
                    ) {
                        const conferenceListContainer =
                            document.getElementById('conferenceList');
                        conferenceListContainer.innerHTML = ''; // Clear previous content

                        conferenceList.forEach((conference) => {
                            const conferenceElement =
                                document.createElement('div');
                            // 행사를 직접적으로 보이게 하는 부분
                            conferenceElement.innerHTML = `
                                <p>행사 이름: ${conference.con_title}</p>
                                <p>행사 시작날짜: ${conference.con_start_date}</p>
                                <button onclick="approveConference(${conference.con_id})">등록 승인</button>
                                <button onclick="rejectConference(${conference.con_id})">승인 거절</button>
                            `;
                            // conference.{DB변수명}으로 접근할 수 있습니다. 등록 신청한 행사가 예쁘게 보여졌으면 좋을 것같아요!
                            conferenceListContainer.appendChild(
                                conferenceElement
                            );
                        });
                    } else {
                        const conferenceListContainer =
                            document.getElementById('conferenceList');
                        conferenceListContainer.innerHTML =
                            '신청한 새로운 행사가 없습니다.';
                    }
                }
            });
        }
        function getConferenceHandler() {
                axios({
                    method: 'GET',
                    url: '/manager/conferenceHandler',
                }).then((res) => {
                    if (res.status === 200) {
                        window.location.href = '/manager/conferenceHandler';
                    }
                })
        };

    </script>
</html>
