<!DOCTYPE html>
<html lang="en">
    <head>
        <%- include('../../common/head.ejs', {title: '전체 컨퍼런스 조회 페이지'
        }) %>
        <link
            rel="stylesheet"
            href="/static/css/pages/myPage/managerAside.css"
        />
    </head>
    <body>
        <%- include('../../common/header.ejs') %>

        <main>
            <%- include('./managerAside') %>

            <div class="container">
                <table class="table text-center">
                    <thead>
                        <tr class="border-bottom">
                            <th></th>
                            <th>행사 이름</th>
                            <th>행사 시작일</th>
                            <th>행사 종료일</th>
                            <th>모집 시작일</th>
                            <th>모집 종료일</th>
                            <th>주최 정보</th>
                            <th>조회수</th>
                            <th>승인 여부</th>
                            <th>삭제하기</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <% for (let con of conferences) { %>
                        <tr class="border-bottom" id="tr_<%= con.id %>">
                            <td><%= con.con_id %></td>
                            <td><%= con.con_title %></td>
                            <td><%= con.con_start_date %></td>
                            <td><%= con.con_end_date %></td>
                            <td><%= con.sub_start_date %></td>
                            <td><%= con.sub_end_date %></td>

                            <td><%= con.con_company %></td>
                            <td><%= con.con_count %></td>
                            <td>
                                <%= con.is_agreed === true? '승인':'거절' %>
                            </td>
                            <td><button type="button" onclick="deleteConference('<%=con.con_id%>')">삭제하기</td>
                        </tr>
                        <%}%>
                    </tbody>
                </table>
            </div>
        </main>
        <%- include('../../common/footer.ejs') %>
        <script>
                // 행사 삭제
                function deleteConference(conId) {
                axios({
                    method: 'delete',
                    url: '/manager/deleteConference',
                    data: {
                        con_id: conId,
                    },
                }).then((res) => {
                    if (res.data === true) {
                        alert('행사 삭제되었습니다.');
                    } else {
                        alert('이미 삭제하였거나 삭제할 수 없습니다.');
                    }
                });
            }
        </script>
    </body>
</html>
