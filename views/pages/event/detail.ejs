<!DOCTYPE html>
<html lang="ko">
    <head>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"
        ></script>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
        <%- include('../../common/head.ejs', {title: '행사 상세' }) %>
    </head>

    <body>
        <header><%- include('../../common/header.ejs') %></header>

        <main class="container mt-5">
            <section class="row">
                <!-- 왼쪽 컨텐츠 - 행사 이미지, 정보 -->
                <div class="col-md-6">
                    <!-- 행사 이미지 추가 -->
                    <img
                        src="<%=conference.con_image%>"
                        alt="행사 이미지"
                        class="img-fluid mb-4"
                    />

                    <!-- 행사 정보 -->
                    <h1 class="display-4"><%-conference.con_title%></h1>
                    <p class="mb-2">
                        행사 시작 날짜: <%- conference.con_start_date %>
                    </p>
                    <p class="mb-2">
                        행사 종료 날짜: <%- conference.con_end_date %>
                    </p>
                    <p class="mb-2">
                        행사 분야: <%- conference.con_category %>
                    </p>
                    <p class="mb-2">행사 주최: <%- conference.con_company %></p>
                    <p class="mb-2">
                        행사 URL:
                        <a href="<%= conference.con_company_url %>"
                            ><%- conference.con_company_url %></a
                        >
                    </p>
                    <p class="mb-2">
                        유/무료: <%- conference.con_isfree ? '무료' : '유료' %>
                    </p>
                    <p class="mb-2">행사 주최: <%- conference.con_company %></p>
                    <p class="mb-2">행사규모: <%- conference.con_people %></p>
                </div>
<head>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <%- include('../../common/head.ejs', {title: '행사 상세' }) %>
</head>

<body>
    <header>
      <%- include('../../common/header.ejs') %>
    </header>

    <main class="container mt-5">
        <section class="row">
            <!-- 왼쪽 컨텐츠 - 행사 이미지, 정보 -->
            <div class="col-md-6">
                <!-- 행사 이미지 추가 -->
                <img src="<%=conference.con_image%>" alt="행사 이미지" class="img-fluid mb-4">

                <!-- 행사 정보 -->
                <h1 class="display-4"><%-conference.con_title%></h1>
                <p class="mb-2">행사 시작 날짜: <%- conference.con_start_date %></p>
                <p class="mb-2">행사 종료 날짜: <%- conference.con_end_date %></p>
                <p class="mb-2">행사 분야: <%- conference.con_category %></p>
                <p class="mb-2">행사 주최: <%- conference.con_company %></p>
                <p class="mb-2">행사 URL: <a href="<%= conference.con_company_url %>"><%- conference.con_company_url %></a></p>
                <p class="mb-2">유/무료: <%- conference.con_isfree ? '무료' : '유료' %></p>
                <p class="mb-2">행사 주최: <%- conference.con_company %></p>
                <p class="mb-2">행사규모: <%- conference.con_people %></p>
            </div>

            <!-- 오른쪽 컨텐츠 - 버튼 및 설명 -->
            <div class="col-md-6">
                <div class="my-editor">
                    <button class="btn btn-primary mb-3" onclick=onclick="location.href='/review/write'">이 행사에 대한 리뷰 남기기</button>
                    <button class="btn btn-success mb-3" onclick="saveConference()">이 행사 저장하기(찜하기로 변경할거임)</button>
                    <p class="lead">행사 조회수: <%- conference.con_count %></p>
                    <p class="lead"> <%- confavorite %>명의 사람이 이 행사에 관심이 있습니다!</p>
                    <p class="lead">행사 모집 시작: <%- conference.sub_start_date %></p>
                    <p class="lead">행사 모집 마감: <%- conference.sub_end_date %></p>
                    <p class="lead">온라인/오프라인: <%- conference.is_onoff ? '온라인' : '오프라인' %></p>
                    <% if (!conference.is_onoff) { %>
                        <p class="lead">오프라인 장소: <%- conference.con_location %></p>
                        <p class="lead">상세 주소: <%- conference.con_detail_location %></p>
                    <% } %>
                </div>
            </section>

            <!-- 행사 내용 -->
            <section class="row">
                <div class="col-md-12">
                    <h2 class="mt-4">행사 내용</h2>
                    <p><%- conference.con_detail %></p>
                </div>
            </section>
        </main>

        <footer>
            <!-- Footer 내용 추가 -->
        </footer>

        <!-- Bootstrap 스크립트 추가 -->
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"
        ></script>

        <!-- Axios 라이브러리 및 saveConference 함수 추가 -->
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script>
            async function saveConference(con_id) {
                try {
                    var currentPageURL = window.location.href;

                    // URL에서 숫자 추출
                    var match = currentPageURL.match(/\/(\d+)$/);
                    if (match) {
                        var number1 = match[1];

                        console.log(number1);

                        // axios를 사용하여 POST 요청 보내기
                        const response = await axios.post(`/event/${number1}`, {
                            con_id: number1,
                        });

                        console.log(response.data.result);
                        if (response.data.result === 1) {
                            alert('로그인 후 찜 기능을 이용하실 수 있습니다.');
                        } else if (response.data.result === 2) {
                            alert(
                                '이미 찜한 행사입니다! 찜한 행사는 마이페이지에서 확인할 수 있습니다.'
                            );
                        } else {
                            alert(
                                '찜 성공! 찜한 행사는 마이페이지에서 확인할 수 있습니다.'
                            );
                        }
                    } else {
                        console.error('URL에서 숫자를 찾을 수 없습니다.');
                    }
                } catch (error) {
                    // 예외 처리 코드
                    console.error('에러 발생:', error);
                }
            }
            // async function writeReview(con_id){
            //     try {
            //     var currentPageURL = window.location.href;

            //     // URL에서 숫자 추출
            //     var match = currentPageURL.match(/\/(\d+)$/);
            //     if (match) {
            //       var number1 = match[1];

            //       console.log(number1);

            //       // axios를 사용하여 POST 요청 보내기
            //       const response = await axios.post(`/event/${number1}`, {
            //         con_id: number1
            //       });

            //       console.log(response.data.result);
            //       if (response.data.result === false) {
            //         alert('로그인 후 찜 기능을 이용하실 수 있습니다.');
            //       } else {
            //         alert('찜 성공!');
            //       }
            //     } else {
            //       console.error('URL에서 숫자를 찾을 수 없습니다.');
            //     }
            //   } catch (error) {
            //     // 예외 처리 코드
            //     console.error('에러 발생:', error);
            //   }

            // }
        </script>
    </body>
</html>
